---
import { getCollection } from 'astro:content';
import Layout from '../../layouts/Layout.astro';
import ContentSection from '../../components/ContentSection.astro';
import Image from '../../components/Image.astro';

export async function getStaticPaths() {
  const courses = await getCollection('courses');
  return courses.map((course) => ({
    params: { slug: course.slug },
    props: { course },
  }));
}

const { course } = Astro.props;
const { Content } = await course.render();
---

<Layout title={course.data.title} subtitle={course.data.suburb}>
  <ContentSection>
    {course.data.mainImage && (
      <Image
        src={course.data.mainImage}
        alt={course.data.title}
        class="aspect-[2/1] object-cover"
      />
    )}

    <div class="prose prose-lg max-w-none">
      <Content />
    </div>

    {course.data.address && (
      <div class="mt-8 p-4 bg-gray-50 rounded-lg">
        <h3 class="text-lg font-semibold mb-2">Location</h3>
        <p class="text-gray-700">{course.data.address}</p>
      </div>
    )}

    {course.data.courseMap && (
      <div class="mt-8">
        <h3 class="text-lg font-semibold mb-4">Course Map</h3>
        <Image
          src={course.data.courseMap}
          alt={`${course.data.title} Course Map`}
        />
      </div>
    )}
  </ContentSection>
</Layout>